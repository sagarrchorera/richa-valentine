<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Richa ðŸ’—</title>

  <style>
    *{ box-sizing:border-box; }
    :root{
      --pink1:#ffe1ef;
      --pink2:#f3a4c2;
      --magenta:#b4145a;
      --magenta2:#7b0b3d;
      --glass1: rgba(255,255,255,.18);
      --glass2: rgba(255,255,255,.10);
      --stroke: rgba(255,255,255,.28);
      --shadow: 0 22px 70px rgba(0,0,0,.18);
      --safe-bottom: env(safe-area-inset-bottom, 0px);
      --safe-top: env(safe-area-inset-top, 0px);
    }

    html, body { height:100%; }
    body{
      margin:0;
      min-height:100vh;
      display:flex;
      justify-content:center;
      align-items:center; /* true center */
      padding: calc(10px + var(--safe-top)) 10px calc(10px + var(--safe-bottom));
      font-family: ui-rounded, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(circle at 18% 18%, rgba(255,255,255,.40), rgba(255,255,255,0) 44%),
        radial-gradient(circle at 82% 22%, rgba(255,255,255,.28), rgba(255,255,255,0) 40%),
        radial-gradient(circle at 35% 25%, var(--pink1), var(--pink2));
      overflow:hidden;
      -webkit-tap-highlight-color: transparent;
      touch-action: manipulation;
    }

    body:before{
      content:"";
      position:fixed; inset:0;
      background-image: radial-gradient(rgba(255,255,255,.22) 1px, transparent 1px);
      background-size: 18px 18px;
      opacity:.08;
      pointer-events:none;
      mix-blend-mode: overlay;
    }

    /* Floating hearts */
    .float-heart{
      position:fixed;
      font-size:18px;
      opacity:.20;
      user-select:none;
      pointer-events:none;
      filter: drop-shadow(0 10px 20px rgba(0,0,0,.10));
      animation: drift linear infinite;
    }
    @keyframes drift{
      from{ transform: translateY(35vh) translateX(0) scale(.9); }
      to{ transform: translateY(-120vh) translateX(40px) scale(1.25); }
    }

    /* Centering container */
    .shell{
      width: min(980px, 96vw);
      display:flex;
      justify-content:center;
      align-items:center;
      margin: 0 auto;
    }

    .card{
      width: min(860px, 96vw);
      text-align:center;
      padding: 22px 18px 16px;
      border-radius: 30px;
      background: linear-gradient(180deg, rgba(255,255,255,.20), rgba(255,255,255,.10));
      border: 1px solid rgba(255,255,255,.28);
      box-shadow: var(--shadow);
      backdrop-filter: blur(14px);
      position:relative;
      overflow:hidden;
    }
    .card:after{
      content:"";
      position:absolute;
      width:520px; height:520px;
      right:-260px; top:-280px;
      background: radial-gradient(circle, rgba(255,255,255,.26), rgba(255,255,255,0) 60%);
      transform: rotate(-8deg);
      pointer-events:none;
      opacity:.55;
    }

    h1{
      margin: 8px 0 12px;
      font-weight: 1000;
      color: var(--magenta);
      font-size: clamp(22px, 6vw, 56px);
      letter-spacing: .2px;
      text-shadow: 0 2px 0 rgba(255,255,255,.35);
      padding: 0 6px;
    }

    .media{
      width: 230px;
      height: 200px;
      margin: 0 auto 6px;
      display:grid;
      place-items:center;
      position:relative;
      animation: bob 2.8s ease-in-out infinite;
      z-index:1;
    }
    @keyframes bob{0%,100%{transform:translateY(0)}50%{transform:translateY(-7px)}}

    /* Photo frame (no cropping) */
    .photoFrame{
      width: 155px;
      height: 155px;
      border-radius: 28px;
      padding: 7px;
      background: conic-gradient(from 180deg, rgba(255,90,165,.95), rgba(255,210,228,.92), rgba(255,90,165,.95));
      box-shadow: 0 18px 46px rgba(0,0,0,.16);
      position:relative;
    }
    .photoInner{
      width:100%;
      height:100%;
      border-radius: 22px;
      background: rgba(255,255,255,.92);
      display:grid;
      place-items:center;
      overflow:hidden;
      position:relative;
      border: 4px solid rgba(255,255,255,.55);
    }
    .photoInner:before{
      content:"";
      position:absolute; inset:-10px;
      background: url('richa.jpg') center/cover no-repeat;
      filter: blur(12px) saturate(1.1);
      opacity:.32;
      transform: scale(1.1);
    }
    .photo{
      width:100%;
      height:100%;
      object-fit: contain;
      display:block;
      position:relative;
      z-index:1;
    }

    .media:before,.media:after{
      content:"ðŸ’—";
      position:absolute;
      font-size:18px;
      opacity:.88;
      filter: drop-shadow(0 10px 18px rgba(0,0,0,.14));
      animation: pop 1.6s ease-in-out infinite;
      user-select:none;
      pointer-events:none;
      z-index:2;
    }
    .media:before{left:18px; top:14px;}
    .media:after{right:20px; bottom:18px; animation-delay:.35s}
    @keyframes pop{0%,100%{transform:translateY(0) scale(1)}50%{transform:translateY(-7px) scale(1.18)}}

    /* Button zone */
    .btnZone{
      position:relative;
      width:min(760px, 96vw);
      height: 280px;
      margin: 8px auto 0;
      display:flex;
      align-items:center;
      justify-content:center;
      z-index:2;
    }

    button{ touch-action: manipulation; }

    .yes{
      border:none;
      border-radius: 18px;
      padding: 24px 62px;
      font-size: clamp(34px, 7vw, 56px);
      font-weight: 1000;
      color:#fff;
      background: linear-gradient(180deg, #37d36c, #1f9f4b);
      box-shadow: 0 18px 0 rgba(0,0,0,.18), 0 20px 40px rgba(0,0,0,.12);
      cursor:pointer;
      transform-origin:center;
      transition: transform 160ms ease, filter 160ms ease, box-shadow 160ms ease;
      min-width: 280px;
      letter-spacing:.3px;
      position:relative;
      z-index:1;
    }
    .yes:before{
      content:"";
      position:absolute; inset:0;
      border-radius: 18px;
      background: radial-gradient(circle at 30% 15%, rgba(255,255,255,.35), rgba(255,255,255,0) 55%);
      opacity:.65;
      pointer-events:none;
    }

    .no{
      position:absolute;
      border:none;
      border-radius: 14px;
      padding: 14px 18px;
      font-size: 16px;
      font-weight: 1000;
      color:#fff;
      background: linear-gradient(180deg, #f05b5b, #b92e2e);
      cursor:pointer;
      opacity:.97;
      box-shadow: 0 16px 34px rgba(0,0,0,.14), inset 0 1px 0 rgba(255,255,255,.25);
      white-space:nowrap;
      z-index:3;
    }

    .subline{
      margin: 12px 0 6px;
      font-size: 18px;
      font-weight: 900;
      color: var(--magenta2);
      opacity:.82;
      min-height: 28px;
      padding: 0 8px;
    }
    .heartsRow{
      margin-top: 10px;
      text-align:center;
      opacity:.16;
      letter-spacing:12px;
      font-size:14px;
      user-select:none;
    }

    /* Confetti */
    .confetti{
      position:fixed; inset:0;
      pointer-events:none;
      overflow:hidden;
      display:none;
      z-index:10;
    }
    .confetti span{
      position:absolute;
      top:-10px;
      font-size:20px;
      animation: fall linear forwards;
      opacity:.95;
      filter: drop-shadow(0 6px 10px rgba(0,0,0,.12));
    }
    @keyframes fall{to{transform:translateY(110vh) rotate(540deg); opacity:1}}

    /* Final screen */
    .finalWrap{ display:none; padding: 14px 0 6px; }
    .finalTitle{
      margin: 6px 0 16px;
      font-weight:1000;
      color: var(--magenta);
      font-size: clamp(22px, 6vw, 56px);
      text-shadow: 0 2px 0 rgba(255,255,255,.35);
      padding: 0 6px;
    }
    .finalText{
      font-size: 18px;
      font-weight: 900;
      color: var(--magenta2);
      opacity:.88;
      margin-bottom: 8px;
      padding: 0 10px;
    }

    /* Music button */
    .musicBtn{
      position: fixed;
      right: 14px;
      bottom: calc(14px + var(--safe-bottom));
      width: 52px;
      height: 52px;
      border-radius: 16px;
      border: 1px solid rgba(255,255,255,.28);
      background: rgba(255,255,255,.18);
      backdrop-filter: blur(10px);
      box-shadow: 0 16px 34px rgba(0,0,0,.14);
      cursor:pointer;
      display:grid;
      place-items:center;
      z-index:20;
      user-select:none;
    }
    .musicBtn:active{ transform: scale(.98); }
    .musicIcon{ font-size:22px; }
    .musicDot{
      width:10px; height:10px; border-radius:50%;
      background: #2ecc71;
      position:absolute; top:10px; right:10px;
      display:none;
      box-shadow: 0 0 0 3px rgba(46,204,113,.25);
    }
    .musicBtn.on .musicDot{ display:block; }
    .musicBtn.off .musicDot{ display:block; background:#e74c3c; box-shadow:0 0 0 3px rgba(231,76,60,.22); }

    /* Mobile alignment tweaks */
    @media (max-width:520px){
      body{ padding: calc(8px + var(--safe-top)) 8px calc(12px + var(--safe-bottom)); }
      .card{ padding: 18px 14px 14px; border-radius: 26px; }
      .btnZone{ height: 250px; }
      .media{ width: 210px; height: 175px; }
      .photoFrame{ width: 142px; height: 142px; border-radius: 26px; }
      .yes{ min-width: 250px; padding: 22px 50px; }
      .subline{ font-size: 16px; }
    }
  </style>
</head>

<body>
  <div class="confetti" id="confetti"></div>

  <!-- Put your own MP3 as music.mp3 in the same folder -->
  <audio id="bgMusic" loop preload="auto">
    <source src="music.mp3" type="audio/mpeg">
  </audio>
  <button class="musicBtn on" id="musicBtn" aria-label="Music">
    <div class="musicDot"></div>
    <div class="musicIcon">ðŸŽµ</div>
  </button>

  <div class="shell">
    <div class="card">
      <div id="mainScreen">
        <h1>Richa, Will you be my Valentine? ðŸ’—</h1>

        <div class="media">
          <div class="photoFrame">
            <div class="photoInner">
              <img class="photo" src="richa.jpg" alt="Richa" />
            </div>
          </div>
        </div>

        <div class="btnZone" id="zone">
          <button class="yes" id="yesBtn" type="button">Yes</button>
          <button class="no" id="noBtn" type="button">No</button>
        </div>

        <div class="subline" id="hintLine"></div>
        <div class="heartsRow">â™¥ â™¥ â™¥ â™¥ â™¥ â™¥</div>
      </div>

      <div class="finalWrap" id="finalScreen">
        <div class="finalTitle">Knew you would say yes! ðŸŽ‰</div>
        <div class="media" style="margin-top:8px">
          <div class="photoFrame">
            <div class="photoInner">
              <img class="photo" src="richa.jpg" alt="Richa" />
            </div>
          </div>
        </div>
        <div class="finalText">You just made me the happiest person! ðŸ’ž</div>
        <div class="heartsRow">â™¥ â™¥ â™¥ â™¥ â™¥ â™¥</div>
      </div>
    </div>
  </div>

  <script>
    // Floating hearts
    (function addFloatingHearts(){
      const hearts = ["ðŸ’—","ðŸ’–","ðŸ’˜","ðŸ’ž"];
      const count = (window.innerWidth < 520) ? 10 : 16;
      for(let i=0;i<count;i++){
        const el = document.createElement("div");
        el.className = "float-heart";
        el.textContent = hearts[Math.floor(Math.random()*hearts.length)];
        el.style.left = Math.floor(Math.random()*101) + "vw";
        el.style.animationDuration = (7 + Math.random()*9).toFixed(2) + "s";
        el.style.animationDelay = (-Math.random()*10).toFixed(2) + "s";
        el.style.fontSize = (14 + Math.random()*18).toFixed(0) + "px";
        document.body.appendChild(el);
      }
    })();

    // Elements
    const yesBtn = document.getElementById("yesBtn");
    const noBtn  = document.getElementById("noBtn");
    const zone   = document.getElementById("zone");
    const hint   = document.getElementById("hintLine");
    const mainScreen  = document.getElementById("mainScreen");
    const finalScreen = document.getElementById("finalScreen");
    const confetti = document.getElementById("confetti");

    // Flow (confirmed)
    const noTexts = ["No","Are you positive? ðŸ˜³","Really? ðŸ¥º","Think againâ€¦ ðŸ˜­","Please?? ðŸ’—","Donâ€™t do this ðŸ˜©","Come onnn ðŸ˜­ðŸ˜­","Okay last timeâ€¦ ðŸ™ˆ"];
    const evadeStageAt = 5;

    let noCount = 0;
    let scale = 1;
    let evading = false;

    function rand(min, max){ return Math.floor(Math.random() * (max - min + 1)) + min; }

    function safeMoveNo(){
      const z = zone.getBoundingClientRect();
      const b = noBtn.getBoundingClientRect();
      const pad = 14;

      // No-fly zone around YES to prevent overlap
      const centerX = z.width/2;
      const centerY = z.height/2;
      const noFlyW = Math.min(420, z.width * 0.62);
      const noFlyH = Math.min(190, z.height * 0.62);
      const nfLeft = centerX - noFlyW/2;
      const nfRight= centerX + noFlyW/2;
      const nfTop  = centerY - noFlyH/2;
      const nfBot  = centerY + noFlyH/2;

      const maxX = z.width  - b.width  - pad;
      const maxY = z.height - b.height - pad;

      for(let tries=0; tries<18; tries++){
        const x = rand(pad, Math.max(pad, maxX));
        const y = rand(pad, Math.max(pad, maxY));
        const inNoFly = (x > nfLeft && x < nfRight && y > nfTop && y < nfBot);
        if(!inNoFly){
          noBtn.style.left = x + "px";
          noBtn.style.top  = y + "px";
          return;
        }
      }
      noBtn.style.left = Math.max(pad, maxX) + "px";
      noBtn.style.top  = pad + "px";
    }

function placeNoInitial(){
  const z = zone.getBoundingClientRect();
  const y = yesBtn.getBoundingClientRect();
  const n = noBtn.getBoundingClientRect();

  const pad = 14;      // boundary padding inside the zone
  const gap = 16;      // gap between YES and NO

  // YES position inside the zone
  const yesLeft = y.left - z.left;
  const yesTop  = y.top  - z.top;

  // Try 1: bottom-right corner of YES (like your reference), but OUTSIDE the YES
  let x = yesLeft + y.width - n.width * 0.35;   // slightly tucked near corner
  let yPos = yesTop + y.height - n.height * 0.35;

  // Ensure NO is not inside YES: push it a bit more outward
  x += gap;
  yPos += gap;

  // Clamp inside zone bounds
  x = Math.max(pad, Math.min(x, z.width  - n.width  - pad));
  yPos = Math.max(pad, Math.min(yPos, z.height - n.height - pad));

  // If still overlapping YES (small screens), place it to the RIGHT of YES
  const overlaps =
    x < (yesLeft + y.width) &&
    (x + n.width) > yesLeft &&
    yPos < (yesTop + y.height) &&
    (yPos + n.height) > yesTop;

  if (overlaps) {
    x = yesLeft + y.width + gap;
    yPos = yesTop + (y.height - n.height) / 2;

    // If right side doesn't fit, place it to the LEFT of YES
    if (x + n.width > z.width - pad) {
      x = yesLeft - n.width - gap;
    }

    // If left also doesn't fit, place it BELOW YES (centered)
    if (x < pad) {
      x = yesLeft + (y.width - n.width) / 2;
      yPos = yesTop + y.height + gap;
    }

    // Final clamp
    x = Math.max(pad, Math.min(x, z.width  - n.width  - pad));
    yPos = Math.max(pad, Math.min(yPos, z.height - n.height - pad));
  }

  noBtn.style.left = x + "px";
  noBtn.style.top  = yPos + "px";
}

    function growYes(){
      scale += 0.22;
      yesBtn.style.transform = `scale(${Math.min(scale, 3.2)})`;
    }

    function shake(){
      zone.animate(
        [{transform:"translateX(0)"},{transform:"translateX(-7px)"},{transform:"translateX(7px)"},{transform:"translateX(0)"}],
        {duration:220, iterations:1}
      );
    }

    function updateNoText(){
      const t = noTexts[Math.min(noCount, noTexts.length - 1)];
      noBtn.textContent = t;
    }

    function enableEvade(){
      if(evading) return;
      evading = true;
      hint.textContent = "Try catching the NOâ€¦ ðŸ˜ˆ";

      // Desktop hover escape
      noBtn.addEventListener("mouseenter", safeMoveNo);
      noBtn.addEventListener("mousemove", safeMoveNo);

      // Mobile: escape on touch attempt
      noBtn.addEventListener("pointerdown", (e)=>{
        if(e.pointerType === "touch"){
          safeMoveNo();
        }
      });
    }

    function burstConfetti(){
      confetti.style.display = "block";
      confetti.innerHTML = "";
      const pieces = ["ðŸ’—","ðŸ’–","âœ¨","ðŸŽ‰","ðŸ’˜","ðŸŒ¸"];
      for(let i=0;i<46;i++){
        const s = document.createElement("span");
        s.textContent = pieces[Math.floor(Math.random()*pieces.length)];
        s.style.left = rand(0, 100) + "vw";
        s.style.animationDuration = (1.6 + Math.random()*1.6).toFixed(2) + "s";
        s.style.fontSize = rand(14, 26) + "px";
        confetti.appendChild(s);
      }
      setTimeout(()=>{ confetti.style.display="none"; confetti.innerHTML=""; }, 2600);
    }

    // ===== Music: start on first tap anywhere (mobile-safe) =====
    const music = document.getElementById("bgMusic");
    const musicBtn = document.getElementById("musicBtn");

    function setMusicUI(isOn){
      if(isOn){
        musicBtn.classList.remove("off");
        musicBtn.classList.add("on");
        musicBtn.querySelector(".musicIcon").textContent = "ðŸŽµ";
      }else{
        musicBtn.classList.remove("on");
        musicBtn.classList.add("off");
        musicBtn.querySelector(".musicIcon").textContent = "ðŸ”Š";
      }
    }
    // visually ON by default
    setMusicUI(true);

    async function startMusic(){
      try{
        await music.play();
        setMusicUI(true);
      }catch(e){
        // blocked until user gesture
      }
    }

    // Start music on first interaction anywhere
    document.addEventListener("pointerdown", async ()=>{
      if(music.paused) await startMusic();
    }, { once:false });

    // Toggle button
    musicBtn.addEventListener("pointerup", async ()=>{
      try{
        if(music.paused){ await music.play(); setMusicUI(true); }
        else{ music.pause(); setMusicUI(false); }
      }catch(e){}
    });

    // Attempt autoplay (works on desktop, may be blocked on mobile)
    window.addEventListener("load", ()=>{ startMusic(); });

    // Actions (pointerup works on iPhone)
    async function onNo(){
      if(music.paused) await startMusic();

      if(evading){
        safeMoveNo();
        return;
      }

      updateNoText();
      growYes();
      safeMoveNo();
      shake();

      if(noCount === 2) hint.textContent = "If you say no, Iâ€™ll be really sadâ€¦ ðŸ¥º";
      if(noCount === 4) hint.textContent = "Okayâ€¦ Iâ€™m not giving up ðŸ˜¤ðŸ’—";

      noCount++;

      if(noCount === evadeStageAt){
        noBtn.textContent = "Please?? ðŸ¥º";
        enableEvade();
      }
    }

    async function onYes(){
      if(music.paused) await startMusic();
      mainScreen.style.display = "none";
      finalScreen.style.display = "block";
      burstConfetti();
    }

    noBtn.addEventListener("pointerup", onNo);
    yesBtn.addEventListener("pointerup", onYes);
    noBtn.addEventListener("click", onNo);
    yesBtn.addEventListener("click", onYes);

    // Keep NO positioned nicely on mobile resize
    function relayout(){
      if(!evading) placeNoInitial();
    }
    window.addEventListener("resize", ()=> requestAnimationFrame(relayout));
    window.addEventListener("orientationchange", ()=> setTimeout(()=> requestAnimationFrame(relayout), 220));

    // Initial layout after paint
    requestAnimationFrame(()=>{ placeNoInitial(); });
  </script>
</body>
</html>
